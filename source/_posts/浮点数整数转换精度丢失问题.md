title: 浮点数整数转换精度丢失问题
author: Answer
tags:
  - 浮点数
categories: []
date: 2019-08-10 17:44:00
toc: true
---
### 问题描述
在线支付对接，支付商（微信、支付宝、银联等）的接口中，定义的金额单位不一样，有时候需要对分、元进行相互转换，转换的过程中容易出现问题。

下面的例子，系统中接收的参数是元，请求接口单位是分，在转换过程中出现精度丢失，少扣了用户 1 分钱。
```
public class Main {
    public static void main(String[] args) {
        System.out.println((int) (0.29*100));
    }
}

输出： 28
```

### 错误原因

0.29*100 = 28.999999999999996...

浮点数强制转换成整数类型会舍弃非整数部分

### 解决方法

(int) Math.round(0.29*100)  -> 29


